{"ast":null,"code":"import React,{useState}from\"react\";import{useSelector}from\"react-redux\";import{Map as MapGl}from\"react-map-gl\";import{Container,Nav,Row}from\"react-bootstrap\";import\"./index.css\";import{Popup,Marker}from\"react-map-gl\";import Loader from\"../../components/Loader\";import{useQuery}from\"@tanstack/react-query\";import axios from\"axios\";import SearchBox from\"../../components/SearchBox\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Map(){var _stores;let zoomNumber;window.innerWidth<991?zoomNumber=6.5:zoomNumber=7.7;const[value,setValue]=useState(\"\");const[filter,setFilter]=useState(\"\");const[selectedStore,setSelectedStore]=useState(null);const[viewState,setViewState]=useState({latitude:46.826908,longitude:7.944633,zoom:zoomNumber});const{stores:searchResult}=useSelector(state=>state.storeList);const{data:dataResult,isLoading:loadingStores}=useQuery([\"stores\",filter],()=>axios.get(`/api/search/?type=stores&search_string=${filter}`).then(res=>res.data));const{data:categories}=useQuery([\"product-categories\"],()=>axios.get(\"/api/products/categories/\").then(res=>res.data));let stores;if(value.length>0){stores=searchResult;}else{stores=dataResult;}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Container,{fluid:true,children:[/*#__PURE__*/_jsx(SearchBox,{searchProps:{type:\"map\"},actionType:\"STORE_LIST_RESET\",value:value,setValue:setValue,placeholder:\"Search by name (ex: digitec, nike)\"}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Nav,{className:\"justify-content-evenly map-categories-bar\",children:categories===null||categories===void 0?void 0:categories.map(category=>{return/*#__PURE__*/_jsx(Nav.Item,{children:/*#__PURE__*/_jsx(Nav.Link,{className:\"map-categories-link\",onClick:()=>setFilter(category.name),children:category.name})},category.id);})})}),/*#__PURE__*/_jsx(Row,{className:\"map\",children:/*#__PURE__*/_jsx(MapGl,{...viewState,mapboxAccessToken:process.env.REACT_APP_MAPBOX_TOKEN,mapStyle:\"mapbox://styles/mapbox/light-v11\",onMove:evt=>setViewState(evt.viewState),children:loadingStores?/*#__PURE__*/_jsx(Loader,{}):(_stores=stores)===null||_stores===void 0?void 0:_stores.map((store,index)=>{return/*#__PURE__*/_jsxs(Marker,{latitude:store.latitude,longitude:store.longitude,children:[/*#__PURE__*/_jsx(\"button\",{className:\"marker-btn\",onClick:()=>{setSelectedStore(null);setSelectedStore(store);},children:/*#__PURE__*/_jsx(\"img\",{className:\"map-seller-image\",src:store.profile_image,alt:\"Store Icon\"})}),selectedStore?/*#__PURE__*/_jsx(Popup,{latitude:selectedStore.latitude,longitude:selectedStore.longitude,closeOnClick:false,closeButton:true,onClose:()=>{setSelectedStore(null);},children:/*#__PURE__*/_jsxs(\"div\",{className:\"map-store-container\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-center mt-1\",children:selectedStore.owner_name}),/*#__PURE__*/_jsx(\"h5\",{className:\"text-center mt-1\",children:selectedStore.name}),/*#__PURE__*/_jsx(\"img\",{src:selectedStore.image,alt:\"Store Icon\",className:\"map-store-image\"}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:\"0\",padding:\"0\"},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Address: \"}),selectedStore.address]}),/*#__PURE__*/_jsx(\"strong\",{children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-center\",style:{margin:\"0\",padding:\"0\"},children:[\"Go to\",\" \",/*#__PURE__*/_jsx(\"a\",{href:`#/seller/${selectedStore.owner_id}`,children:selectedStore.owner_name}),\"'s page\"]})})]})}):null]},index);})})})]})});}export default Map;","map":{"version":3,"names":["React","useState","useSelector","Map","MapGl","Container","Nav","Row","Popup","Marker","Loader","useQuery","axios","SearchBox","zoomNumber","window","innerWidth","value","setValue","filter","setFilter","selectedStore","setSelectedStore","viewState","setViewState","latitude","longitude","zoom","stores","searchResult","state","storeList","data","dataResult","isLoading","loadingStores","get","then","res","categories","length","type","map","category","name","id","process","env","REACT_APP_MAPBOX_TOKEN","evt","store","index","profile_image","owner_name","image","margin","padding","address","owner_id"],"sources":["/Users/umit/Desktop/shopping-land express-react/shopping-land/frontend/src/containers/Map/index.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Map as MapGl } from \"react-map-gl\";\nimport { Container, Nav, Row } from \"react-bootstrap\";\nimport \"./index.css\";\nimport { Popup, Marker } from \"react-map-gl\";\nimport Loader from \"../../components/Loader\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport axios from \"axios\";\nimport SearchBox from \"../../components/SearchBox\";\n\nfunction Map() {\n  let zoomNumber;\n  window.innerWidth < 991 ? (zoomNumber = 6.5) : (zoomNumber = 7.7);\n\n  const [value, setValue] = useState(\"\");\n  const [filter, setFilter] = useState(\"\");\n  const [selectedStore, setSelectedStore] = useState(null);\n\n  const [viewState, setViewState] = useState({\n    latitude: 46.826908,\n    longitude: 7.944633,\n    zoom: zoomNumber,\n  });\n\n  const { stores: searchResult } = useSelector((state) => state.storeList);\n\n  const { data: dataResult, isLoading: loadingStores } = useQuery(\n    [\"stores\", filter],\n    () =>\n      axios\n        .get(`/api/search/?type=stores&search_string=${filter}`)\n        .then((res) => res.data)\n  );\n\n  const { data: categories } = useQuery([\"product-categories\"], () =>\n    axios.get(\"/api/products/categories/\").then((res) => res.data)\n  );\n\n  let stores;\n  if (value.length > 0) {\n    stores = searchResult;\n  } else {\n    stores = dataResult;\n  }\n\n  return (\n    <>\n      <Container fluid>\n        <SearchBox\n          searchProps={{ type: \"map\" }}\n          actionType=\"STORE_LIST_RESET\"\n          value={value}\n          setValue={setValue}\n          placeholder=\"Search by name (ex: digitec, nike)\"\n        />\n        <Row>\n          <Nav className=\"justify-content-evenly map-categories-bar\">\n            {categories?.map((category) => {\n              return (\n                <Nav.Item key={category.id}>\n                  <Nav.Link\n                    className=\"map-categories-link\"\n                    onClick={() => setFilter(category.name)}\n                  >\n                    {category.name}\n                  </Nav.Link>\n                </Nav.Item>\n              );\n            })}\n          </Nav>\n        </Row>\n        <Row className=\"map\">\n          <MapGl\n            {...viewState}\n            mapboxAccessToken={process.env.REACT_APP_MAPBOX_TOKEN}\n            mapStyle=\"mapbox://styles/mapbox/light-v11\"\n            onMove={(evt) => setViewState(evt.viewState)}\n          >\n            {loadingStores ? (\n              <Loader />\n            ) : (\n              stores?.map((store, index) => {\n                return (\n                  <Marker\n                    key={index}\n                    latitude={store.latitude}\n                    longitude={store.longitude}\n                  >\n                    <button\n                      className=\"marker-btn\"\n                      onClick={() => {\n                        setSelectedStore(null);\n                        setSelectedStore(store);\n                      }}\n                    >\n                      <img\n                        className=\"map-seller-image\"\n                        src={store.profile_image}\n                        alt=\"Store Icon\"\n                      />\n                    </button>\n\n                    {selectedStore ? (\n                      <Popup\n                        latitude={selectedStore.latitude}\n                        longitude={selectedStore.longitude}\n                        closeOnClick={false}\n                        closeButton={true}\n                        onClose={() => {\n                          setSelectedStore(null);\n                        }}\n                      >\n                        <div className=\"map-store-container\">\n                          <h4 className=\"text-center mt-1\">\n                            {selectedStore.owner_name}\n                          </h4>\n                          <h5 className=\"text-center mt-1\">\n                            {selectedStore.name}\n                          </h5>\n                          <img\n                            src={selectedStore.image}\n                            alt=\"Store Icon\"\n                            className=\"map-store-image\"\n                          />\n                          <p style={{ margin: \"0\", padding: \"0\" }}>\n                            <strong>Address: </strong>\n                            {selectedStore.address}\n                          </p>\n                          <strong>\n                            <p\n                              className=\"text-center\"\n                              style={{ margin: \"0\", padding: \"0\" }}\n                            >\n                              Go to{\" \"}\n                              <a href={`#/seller/${selectedStore.owner_id}`}>\n                                {selectedStore.owner_name}\n                              </a>\n                              's page\n                            </p>\n                          </strong>\n                        </div>\n                      </Popup>\n                    ) : null}\n                  </Marker>\n                );\n              })\n            )}\n          </MapGl>\n        </Row>\n      </Container>\n    </>\n  );\n}\n\nexport default Map;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}